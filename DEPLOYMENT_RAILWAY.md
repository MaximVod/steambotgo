# Деплой на Railway

## Подготовка

1. Создайте аккаунт на [Railway](https://railway.app/)
2. Установите Railway CLI:
   ```bash
   npm install -g @railway/cli
   # или
   curl -fsSL https://railway.app/install.sh | sh
   ```

## Деплой

1. Авторизуйтесь в Railway:
   ```bash
   railway login
   ```

2. Инициализируйте проект:
   ```bash
   railway init
   ```

3. Установите переменные окружения (одним из способов):
   
   Вариант 1:
   ```bash
   railway variables set TELEGRAM_BOT_TOKEN="ваш_токен_бота_здесь"
   ```
   
   Вариант 2:
   ```bash
   railway config set TELEGRAM_BOT_TOKEN="ваш_токен_бота_здесь"
   ```
   
   Вариант 3 (через веб-интерфейс):
   - Перейдите на сайт Railway
   - Откройте свой проект
   - Перейдите во вкладку "Variables"
   - Добавьте новую переменную с названием "TELEGRAM_BOT_TOKEN" и значением вашего токена

4. Деплой проекта:
   ```bash
   railway deploy
   ```

## Тестирование локально

### Создание тестового бота

Для локальной разработки рекомендуется создать отдельного тестового бота:

1. Напишите @BotFather в Telegram
2. Используйте команду /newbot для создания нового бота
3. Придумайте ему имя вроде "SteamBotTest" или "DevSteamBot"
4. Сохраните токен, который вы получите

### Использование разных токенов

Приложение автоматически определяет, где оно запущено:
- При запуске на Railway: использует переменную TELEGRAM_BOT_TOKEN из настроек Railway
- При запуске локально: загружает .env файл и использует токен из него

### Установка токена бота

Для локального тестирования создайте файл `.env` в корне проекта и поместите туда токен тестового бота:

```
TELEGRAM_BOT_TOKEN=токен_тестового_бота
```

### Запуск приложения локально

1. Убедитесь, что у вас установлен Go (версии 1.22 или выше)
2. В корне проекта создайте файл `.env` с токеном тестового бота
3. Запустите приложение командой:
   ```bash
   go run cmd/main.go
   ```

Приложение запустится локально и тестовый бот будет работать на вашем компьютере. Это позволит безопасно тестировать новые фичи без влияния на продакшен-бота.

### Рекомендации по разработке

1. **Локальная разработка**: Добавляйте новые фичи и тестируйте их с помощью тестового бота локально
2. **Разделение окружений**: Используйте одного бота для разработки и тестирования, другого (основного) - для публичного использования
3. **Использование go-reload**: Для более удобной разработки можно использовать инструменты вроде `air` для автоматической перезагрузки при изменении кода:
   ```bash
   go install github.com/cosmtrek/air@latest
   air
   ```

4. **Тестирование**: После добавления новых фич протестируйте их локально с тестовым ботом, а затем задеплойте на Railway с основным токеном

## Альтернативный способ через GitHub

1. Свяжите ваш GitHub репозиторий с Railway
2. Добавьте переменную окружения `TELEGRAM_BOT_TOKEN` в настройках проекта на Railway
3. Railway будет автоматически деплоить изменения при пуше в ветку

## Важно

- Файл `.env` не будет загружен на Railway, все переменные окружения должны быть установлены через панель управления Railway или CLI
- Убедитесь, что ваш бот настроен на работу с серверами Railway (иногда требуются дополнительные настройки вебхуков)
